{"version":3,"sources":["../static/js/18.68c3c657.chunk.js","pages/PDFReport/Report/UploadReport.js"],"names":["webpackJsonp","451","module","__webpack_exports__","__webpack_require__","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","_dec","_class","_class2","_temp2","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_0_react___default","n","__WEBPACK_IMPORTED_MODULE_2_react_helmet__","__WEBPACK_IMPORTED_MODULE_3_lodash__","__WEBPACK_IMPORTED_MODULE_3_lodash___default","__WEBPACK_IMPORTED_MODULE_5_antd__","__WEBPACK_IMPORTED_MODULE_6_react_redux__","__WEBPACK_IMPORTED_MODULE_7_axiosInst__","__WEBPACK_IMPORTED_MODULE_8_CommonConfig__","_createClass","defineProperties","target","props","descriptor","key","protoProps","staticProps","Option","mapStateToProps","_ref","user","app","userState","columns","title","dataIndex","render","text","record","a","createElement","categoryName","UploadPDFPage","_Component","_ref2","_temp","_this","_ret","this","_len","arguments","args","_key","getPrototypeOf","apply","concat","state","loading","reportCategories","selectedCategory","undefined","selectedDept","reportList","selectedRowKeys","loadCategory","setState","get","then","res","data","catch","err","alert","handleSelectCategory","node","extra","console","log","handleDeleteReport","delete","reportIds","temp","filter","obj","includes","_id","rowSelection","onChange","selectedRows","_this2","params","_this3","_state","type","justify","span","style","width","marginBottom","onSelect","placeholder","dept","map","o","name","allowClear","dropdownStyle","maxHeight","overflow","treeData","treeDefaultExpandAll","disabled","action","baseURL","multiple","category","info","file","response","status","push","onConfirm","okText","cancelText","size","marginTop","dataSource","bordered","rowKey","defaultProps","pathName"],"mappings":"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","file":"static/js/18.68c3c657.chunk.js","sourcesContent":["webpackJsonp([18],{\n\n/***/ 451:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_components_LayoutComponents_Page__ = __webpack_require__(74);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_react_helmet__ = __webpack_require__(73);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_react_helmet___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_react_helmet__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_components_LayoutComponents_CustomCard__ = __webpack_require__(448);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_antd__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_react_redux__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_axiosInst__ = __webpack_require__(47);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_CommonConfig__ = __webpack_require__(450);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _dec,_class,_class2,_temp2;function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var Option=__WEBPACK_IMPORTED_MODULE_5_antd__[\"x\" /* Select */].Option;var mapStateToProps=function mapStateToProps(_ref,props){var app=_ref.app;var userState=app.userState;return{user:userState};};var columns=[{title:'File Name',dataIndex:'reportName',key:'reportName'},{title:'Category',dataIndex:'category',key:'category',render:function render(text,record){return __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('p',null,text.categoryName);}}];var UploadPDFPage=(_dec=Object(__WEBPACK_IMPORTED_MODULE_6_react_redux__[\"b\" /* connect */])(mapStateToProps),_dec(_class=(_temp2=_class2=function(_Component){_inherits(UploadPDFPage,_Component);function UploadPDFPage(){var _ref2;var _temp,_this,_ret;_classCallCheck(this,UploadPDFPage);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref2=UploadPDFPage.__proto__||Object.getPrototypeOf(UploadPDFPage)).call.apply(_ref2,[this].concat(args))),_this),_this.state={loading:false,reportCategories:[],selectedCategory:undefined,selectedDept:undefined,reportList:[],selectedRowKeys:[]},_this.loadCategory=function(value){_this.setState({loading:true,selectedDept:value});__WEBPACK_IMPORTED_MODULE_7_axiosInst__[\"a\" /* default */].get('api/pdf/category/'+value).then(function(res){res.data=res.data===''?[]:res.data;_this.setState({loading:false,reportCategories:res.data});}).catch(function(err){alert(err);});},_this.handleSelectCategory=function(value,node,extra){console.log(value);_this.setState({selectedCategory:value});},_this.handleDeleteReport=function(){__WEBPACK_IMPORTED_MODULE_7_axiosInst__[\"a\" /* default */].delete('api/pdf/report/delete',{data:{reportIds:_this.state.selectedRowKeys}}).then(function(res){var temp=[].concat(_toConsumableArray(_this.state.reportList));temp=temp.filter(function(obj){return!__WEBPACK_IMPORTED_MODULE_3_lodash___default.a.includes(res.data,obj._id);});_this.setState({reportList:temp,selectedRowKeys:[]});}).catch(function(err){console.log(err);});},_this.rowSelection={onChange:function onChange(selectedRowKeys,selectedRows){_this.setState({selectedRowKeys:selectedRowKeys});}},_temp),_possibleConstructorReturn(_this,_ret);}_createClass(UploadPDFPage,[{key:'componentDidMount',value:function componentDidMount(){var _this2=this;this.setState({loading:true});/*axios\r\n      .get(`api/pdf/category/${this.props.user.dept._id}`)\r\n      .then(res => {\r\n        this.setState({ loading: false, reportCategories: res.data })\r\n      })\r\n      .catch(err => {\r\n        alert(err)\r\n      })*/__WEBPACK_IMPORTED_MODULE_7_axiosInst__[\"a\" /* default */].get('api/pdf/report/',{params:{user:this.props.user._id}}).then(function(res){_this2.setState({reportList:res.data});}).catch(function(err){alert(err);});}},{key:'render',value:function render(){var _this3=this;var user=this.props.user;var _state=this.state,reportCategories=_state.reportCategories,loading=_state.loading,selectedCategory=_state.selectedCategory,reportList=_state.reportList,selectedRowKeys=_state.selectedRowKeys,selectedDept=_state.selectedDept;return __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"w\" /* Row */],{type:'flex',justify:'start'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"h\" /* Col */],{span:5},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"x\" /* Select */],{style:{width:'90%',marginBottom:'5px'},onSelect:this.loadCategory,placeholder:'Select department'},user.dept.length>0?user.dept.map(function(o){return __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(Option,{key:o._id,value:o._id},o.name);}):null),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"F\" /* TreeSelect */],{allowClear:true,placeholder:'Select report category',style:{width:'90%',marginBottom:'5px'},dropdownStyle:{maxHeight:400,overflow:'auto'},treeData:reportCategories,treeDefaultExpandAll:true,disabled:loading,onChange:this.handleSelectCategory}),',',__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"G\" /* Upload */],{disabled:selectedCategory===undefined?true:false,name:'reportFile',action:__WEBPACK_IMPORTED_MODULE_8_CommonConfig__[\"a\" /* default */].baseURL+'api/pdf/report/add',multiple:true,data:{category:selectedCategory,user:user._id,dept:selectedDept},onChange:function onChange(info){var res=info.file.response;var status=info.file.status;if(status==='done'){var temp=[].concat(_toConsumableArray(reportList));temp.push(res);_this3.setState({reportList:[].concat(_toConsumableArray(temp))});}else if(status==='error'){console.log(res);}}},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"e\" /* Button */],null,'Choose file(s) to upload'))),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"h\" /* Col */],{span:19},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"v\" /* Popconfirm */],{title:'Are you sure delete?',onConfirm:this.handleDeleteReport,okText:'Yes',cancelText:'No'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"e\" /* Button */],{type:'danger',size:'small',disabled:selectedRowKeys.length===0?true:false},'Delete')),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"B\" /* Table */],{style:{marginTop:'5px'},columns:columns,dataSource:reportList,bordered:true,size:'small',rowKey:'_id',rowSelection:this.rowSelection})));}}]);return UploadPDFPage;}(__WEBPACK_IMPORTED_MODULE_0_react__[\"Component\"]),_class2.defaultProps={pathName:'Upload PDF Report'},_temp2))||_class);/* harmony default export */ __webpack_exports__[\"default\"] = (UploadPDFPage);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/18.68c3c657.chunk.js","import React, { Component } from 'react'\r\nimport Page from 'components/LayoutComponents/Page'\r\nimport Helmet from 'react-helmet'\r\nimport _ from 'lodash'\r\nimport CustomCard from 'components/LayoutComponents/CustomCard'\r\nimport { Row, Col, Button, Upload, TreeSelect, message, Table, Select, Popconfirm } from 'antd'\r\nimport { connect } from 'react-redux'\r\n\r\nimport axios from 'axiosInst'\r\nimport config from 'CommonConfig'\r\n\r\nconst Option = Select.Option\r\n\r\nconst mapStateToProps = ({ app }, props) => {\r\n  const { userState } = app\r\n  return {\r\n    user: userState,\r\n  }\r\n}\r\n\r\nconst columns = [\r\n  {\r\n    title: 'File Name',\r\n    dataIndex: 'reportName',\r\n    key: 'reportName',\r\n  },\r\n  {\r\n    title: 'Category',\r\n    dataIndex: 'category',\r\n    key: 'category',\r\n    render: (text, record) => {\r\n      return <p>{text.categoryName}</p>\r\n    },\r\n  },\r\n]\r\n\r\n@connect(mapStateToProps)\r\nclass UploadPDFPage extends Component {\r\n  static defaultProps = {\r\n    pathName: 'Upload PDF Report',\r\n  }\r\n\r\n  state = {\r\n    loading: false,\r\n    reportCategories: [],\r\n    selectedCategory: undefined,\r\n    selectedDept: undefined,\r\n    reportList: [],\r\n    selectedRowKeys: [],\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setState({ loading: true })\r\n    /*axios\r\n      .get(`api/pdf/category/${this.props.user.dept._id}`)\r\n      .then(res => {\r\n        this.setState({ loading: false, reportCategories: res.data })\r\n      })\r\n      .catch(err => {\r\n        alert(err)\r\n      })*/\r\n\r\n    axios\r\n      .get(`api/pdf/report/`, { params: { user: this.props.user._id } })\r\n      .then(res => {\r\n        this.setState({ reportList: res.data })\r\n      })\r\n      .catch(err => {\r\n        alert(err)\r\n      })\r\n  }\r\n\r\n  loadCategory = value => {\r\n    this.setState({ loading: true, selectedDept: value })\r\n    axios\r\n      .get(`api/pdf/category/${value}`)\r\n      .then(res => {\r\n        res.data = res.data === '' ? [] : res.data\r\n        this.setState({ loading: false, reportCategories: res.data })\r\n      })\r\n      .catch(err => {\r\n        alert(err)\r\n      })\r\n  }\r\n\r\n  handleSelectCategory = (value, node, extra) => {\r\n    console.log(value)\r\n    this.setState({ selectedCategory: value })\r\n  }\r\n\r\n  handleDeleteReport = () => {\r\n    axios\r\n      .delete('api/pdf/report/delete', { data: { reportIds: this.state.selectedRowKeys } })\r\n      .then(res => {\r\n        let temp = [...this.state.reportList]\r\n        temp = temp.filter(obj => !_.includes(res.data, obj._id))\r\n        this.setState({ reportList: temp, selectedRowKeys: [] })\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n  }\r\n\r\n  rowSelection = {\r\n    onChange: (selectedRowKeys, selectedRows) => {\r\n      this.setState({ selectedRowKeys })\r\n    },\r\n  }\r\n\r\n  render() {\r\n    const { user } = this.props\r\n    const {\r\n      reportCategories,\r\n      loading,\r\n      selectedCategory,\r\n      reportList,\r\n      selectedRowKeys,\r\n      selectedDept,\r\n    } = this.state\r\n    return (\r\n      <Row type=\"flex\" justify=\"start\">\r\n        <Col span={5}>\r\n          <Select\r\n            style={{ width: '90%', marginBottom: '5px' }}\r\n            onSelect={this.loadCategory}\r\n            placeholder=\"Select department\"\r\n          >\r\n            {user.dept.length > 0\r\n              ? user.dept.map(o => {\r\n                  return (\r\n                    <Option key={o._id} value={o._id}>\r\n                      {o.name}\r\n                    </Option>\r\n                  )\r\n                })\r\n              : null}\r\n          </Select>\r\n          <TreeSelect\r\n            allowClear={true}\r\n            placeholder=\"Select report category\"\r\n            style={{ width: '90%', marginBottom: '5px' }}\r\n            dropdownStyle={{ maxHeight: 400, overflow: 'auto' }}\r\n            treeData={reportCategories}\r\n            treeDefaultExpandAll\r\n            disabled={loading}\r\n            onChange={this.handleSelectCategory}\r\n          />,\r\n          <Upload\r\n            disabled={selectedCategory === undefined ? true : false}\r\n            name=\"reportFile\"\r\n            action={`${config.baseURL}api/pdf/report/add`}\r\n            multiple={true}\r\n            data={{\r\n              category: selectedCategory,\r\n              user: user._id,\r\n              dept: selectedDept,\r\n            }}\r\n            onChange={info => {\r\n              const res = info.file.response\r\n              const status = info.file.status\r\n              if (status === 'done') {\r\n                let temp = [...reportList]\r\n                temp.push(res)\r\n                this.setState({ reportList: [...temp] })\r\n              } else if (status === 'error') {\r\n                console.log(res)\r\n              }\r\n            }}\r\n          >\r\n            <Button>Choose file(s) to upload</Button>\r\n          </Upload>\r\n        </Col>\r\n        <Col span={19}>\r\n          <Popconfirm\r\n            title=\"Are you sure delete?\"\r\n            onConfirm={this.handleDeleteReport}\r\n            okText=\"Yes\"\r\n            cancelText=\"No\"\r\n          >\r\n            <Button\r\n              type=\"danger\"\r\n              size=\"small\"\r\n              disabled={selectedRowKeys.length === 0 ? true : false}\r\n            >\r\n              Delete\r\n            </Button>\r\n          </Popconfirm>\r\n          <Table\r\n            style={{ marginTop: '5px' }}\r\n            columns={columns}\r\n            dataSource={reportList}\r\n            bordered\r\n            size=\"small\"\r\n            rowKey=\"_id\"\r\n            rowSelection={this.rowSelection}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    )\r\n  }\r\n}\r\n\r\nexport default UploadPDFPage\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/PDFReport/Report/UploadReport.js"],"sourceRoot":""}